<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Medical Coding Portfolio Pro</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
<style>
body{font-family:'Segoe UI',sans-serif; background:#e0e0e0; transition:.3s;}
body.dark{background:#1e1e1e; color:#fff;}
.neo{background:#e0e0e0;border-radius:20px;box-shadow:8px 8px 16px #bebebe,-8px -8px 16px #fff;padding:20px;margin-bottom:20px;transition:.3s;}
body.dark .neo{background:#2a2a2a;box-shadow:8px 8px 16px #111,-8px -8px 16px #333;}
.navbar{border-radius:20px;box-shadow:5px 5px 10px #bebebe,-5px -5px 10px #fff;transition:.3s;}
body.dark .navbar{box-shadow:5px 5px 10px #111,-5px -5px 10px #333;}
.navbar-brand{font-weight:bold;}
.nav-link{transition:.2s;border-radius:12px;padding:6px 12px;}
.nav-link:hover{box-shadow:inset 3px 3px 6px #bebebe,inset -3px -3px 6px #fff;color:#0d6efd !important;}
.neo-btn{border:none;border-radius:12px;box-shadow:5px 5px 10px #bebebe,-5px -5px 10px #fff;cursor:pointer;width:42px;height:38px;display:flex;justify-content:center;align-items:center;transition:.2s;}
.neo-btn:hover{box-shadow:8px 8px 14px #bebebe,-8px -8px 14px #fff;}
body.dark .neo-btn{box-shadow:5px 5px 10px #111,-5px -5px 10px #333;}
body.dark .neo-btn:hover{box-shadow:8px 8px 14px #111,-8px -8px 14px #333;}
.table thead{background:#f0f0f0;}
body.dark .table thead{background:#333;}
.icon-btn{border:none;background:none;cursor:pointer;font-size:1.2rem;margin-left:6px;transition:.2s;}
.icon-btn:hover{transform:scale(1.2);}
#toast-container{position:fixed;top:20px;right:20px;z-index:9999;}
.toast{min-width:220px;border-radius:16px;box-shadow:5px 5px 12px #bebebe,-5px -5px 12px #fff;margin-bottom:12px;padding:12px;display:flex;align-items:center;transition:.3s;font-weight:500;}
.toast.success{background:#d4edda;color:#155724;}
.toast.error{background:#f8d7da;color:#721c24;}
.toast.info{background:#d1ecf1;color:#0c5460;}
.toast i{margin-right:10px;font-size:1.3rem;}
mark{background:#fffb91;border-radius:3px;padding:0 3px;}
</style>
</head>
<body class="container my-4">

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg neo px-3 py-2 mb-4">
  <a class="navbar-brand" href="#">Portfolio</a>
  <div class="d-flex d-lg-none ms-auto gap-2 align-items-center">
    <button class="neo-btn" id="themeBtnMobile" title="Toggle Theme"><i class="bi bi-moon-fill"></i></button>
    <button class="neo-btn navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mobileMenu">
      <i class="bi bi-list"></i>
    </button>
  </div>
  <div class="collapse navbar-collapse" id="mobileMenu">
    <ul class="navbar-nav ms-auto flex-column flex-lg-row gap-lg-3 mt-2 mt-lg-0">
      <li class="nav-item"><a class="nav-link" href="#drugs">Drugs</a></li>
      <li class="nav-item"><a class="nav-link" href="#severity">Severity</a></li>
      <li class="nav-item"><a class="nav-link" href="#about">About</a></li>
      <li class="nav-item"><a class="nav-link" href="#contact">Contact</a></li>
    </ul>
    <div class="d-none d-lg-block ms-lg-3">
      <button class="neo-btn" id="themeBtn" title="Toggle Theme"><i class="bi bi-moon-fill"></i></button>
    </div>
  </div>
</nav>

<!-- BANNER -->
<div class="neo text-center mb-4">
  <img src="Banner.png" alt="Banner" class="img-fluid rounded">
</div>

<!-- DRUGS SECTION -->
<div class="neo" id="drugs">
<h5><i class="bi bi-capsule"></i> Drugs</h5>
<div class="d-flex gap-2 mb-2">
  <input id="drugsSearch" class="form-control" placeholder="Search Drugs or Diseases">
  <button class="neo-btn text-success" onclick="openModal('drugs')" title="Add"><i class="bi bi-plus-lg"></i></button>
</div>
<table class="table">
<thead><tr><th>Drug</th><th>Disease</th><th>ICD</th><th>Action</th></tr></thead>
<tbody id="drugsBody"></tbody>
</table>
</div>

<!-- SEVERITY SECTION -->
<div class="neo" id="severity">
<h5><i class="bi bi-exclamation-triangle"></i> Severity</h5>
<div class="d-flex gap-2 mb-2">
  <input id="severitySearch" class="form-control" placeholder="Search Severity">
  <button class="neo-btn text-success" onclick="openModal('severity')" title="Add"><i class="bi bi-plus-lg"></i></button>
</div>
<table class="table">
<thead><tr><th>Condition 1</th><th>Condition 2</th><th>Coded</th><th>Action</th></tr></thead>
<tbody id="severityBody"></tbody>
</table>
</div>

<!-- ABOUT SECTION -->
<div class="neo" id="about">
<h5><i class="bi bi-info-circle"></i> About</h5>
<p>This portfolio demonstrates Drugs and Severity CRUD with Google Sheets, using a pro neomorphic UI and smooth UX.</p>
</div>

<!-- CONTACT SECTION -->
<div class="neo" id="contact">
<h5><i class="bi bi-envelope"></i> Contact</h5>
<input class="form-control mb-2" placeholder="Name">
<input class="form-control mb-2" placeholder="Email">
<textarea class="form-control mb-2" placeholder="Message"></textarea>
<button class="btn btn-primary"><i class="bi bi-send"></i> Send</button>
</div>

<!-- MODAL -->
<div class="modal fade" id="modal">
<div class="modal-dialog">
<div class="modal-content p-3 neo">
<input type="hidden" id="id">
<input id="c1" class="form-control mb-2" placeholder="Field 1">
<input id="c2" class="form-control mb-2" placeholder="Field 2">
<input id="c3" class="form-control mb-2" placeholder="Field 3">
<input id="pw" class="form-control mb-2" placeholder="Password">
<button class="btn btn-primary w-100" onclick="save()"><i class="bi bi-check-lg"></i> Save</button>
</div>
</div>
</div>

<!-- TOAST CONTAINER -->
<div id="toast-container"></div>

<script>
const API="https://script.google.com/macros/s/AKfycbxhBWtpAR6cIbgTQ9_8HlaG9hB_S6rhhK-AmSI_LmimiNNqgYILGv6Ih-Cj77RxMd3G/exec"; // Replace with your Apps Script URL
let drugsData=[], severityData=[], moduleName="", edit=false;

// Helper for highlighting
function highlight(text,q){ if(!q) return text; const regex=new RegExp(`(${q})`,'gi'); return text.replace(regex,'<mark>$1</mark>'); }

// Load all data
function loadAll(){
 fetch(`${API}?action=read&module=drugs`).then(r=>r.json()).then(d=>{drugsData=d; renderDrugs();});
 fetch(`${API}?action=read&module=severity`).then(r=>r.json()).then(d=>{severityData=d; renderSeverity();});
}
loadAll();

// Render Drugs table
function renderDrugs(query=""){
 const body=document.getElementById('drugsBody'); body.innerHTML="";
 if(!query) return;
 drugsData.filter(r=>{
   return r[1].toLowerCase().includes(query.toLowerCase()) || r[2].toLowerCase().includes(query.toLowerCase());
 }).forEach(r=>{
   body.innerHTML+=`<tr>
     <td>${highlight(r[1],query)}</td>
     <td>${highlight(r[2],query)}</td>
     <td>${r[3]||''}</td>
     <td>
       <button class="icon-btn text-primary" onclick='editRow("drugs",${JSON.stringify(r)})'><i class="bi bi-pencil-square"></i></button>
       <button class="icon-btn text-danger" onclick='delRow("drugs",${r[0]})'><i class="bi bi-trash"></i></button>
     </td>
   </tr>`;
 });
}

// Render Severity table
function renderSeverity(query=""){
 const body=document.getElementById('severityBody'); body.innerHTML="";
 if(!query) return;
 severityData.filter(r=>{
   return r[1].toLowerCase().includes(query.toLowerCase()) || r[2].toLowerCase().includes(query.toLowerCase());
 }).forEach(r=>{
   body.innerHTML+=`<tr>
     <td>${highlight(r[1],query)}</td>
     <td>${highlight(r[2],query)}</td>
     <td>${r[3]||''}</td>
     <td>
       <button class="icon-btn text-primary" onclick='editRow("severity",${JSON.stringify(r)})'><i class="bi bi-pencil-square"></i></button>
       <button class="icon-btn text-danger" onclick='delRow("severity",${r[0]})'><i class="bi bi-trash"></i></button>
     </td>
   </tr>`;
 });
}

// Search events
document.getElementById("drugsSearch").onkeyup=e=>renderDrugs(e.target.value);
document.getElementById("severitySearch").onkeyup=e=>renderSeverity(e.target.value);

// Modal
function openModal(module){ moduleName=module; edit=false; id.value=c1.value=c2.value=c3.value=pw.value=""; new bootstrap.Modal(document.getElementById("modal")).show(); }
function editRow(module,r){ moduleName=module; edit=true; id.value=r[0]; c1.value=r[1]; c2.value=r[2]; c3.value=r[3]||""; new bootstrap.Modal(document.getElementById("modal")).show(); }

// Toast
function showToast(type,msg){ const t=document.createElement("div"); t.className=`toast ${type}`; t.innerHTML=(type==='success'?'<i class="bi bi-check-circle"></i>':type==='error'?'<i class="bi bi-x-circle"></i>':'<i class="bi bi-info-circle"></i>') + msg; document.getElementById("toast-container").appendChild(t); setTimeout(()=>t.remove(),3000); }

// Save
function save(){
 if(!pw.value){ showToast('error','Password required'); return; }
 const params = new URLSearchParams({action: edit?"update":"add", module: moduleName, id: id.value, col1:c1.value,col2:c2.value,col3:c3.value,password:pw.value});
 fetch(API,{method:"POST",body:params}).then(r=>r.json()).then(res=>{
   if(res.status==='failed') showToast('error','Wrong password');
   else { showToast('success',edit?'Updated':'Added'); loadAll(); bootstrap.Modal.getInstance(document.getElementById("modal")).hide(); }
 });
}

// Delete
function delRow(module,id){ const pwd=prompt("Password"); if(!pwd) return; const params=new URLSearchParams({action:"delete",module,id,password:pwd}); fetch(API,{method:"POST",body:params}).then(r=>r.json()).then(res=>{ if(res.status==='failed') showToast('error','Wrong password'); else { showToast('info','Deleted'); loadAll(); } }); }

// Theme toggle
document.getElementById("themeBtn").onclick =
document.getElementById("themeBtnMobile").onclick =
()=>document.body.classList.toggle("dark");

</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
